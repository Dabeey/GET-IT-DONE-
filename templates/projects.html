{% extends 'base.html' %}

{% block title %}Projects - Get It Done!{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="text-center mb-4">Projects</h1>
    <div class="accordion" id="projectsAccordion">
        {% for project in projects %}
        <div class="accordion-item">
            <h2 class="accordion-header" id="heading{{ project.id }}">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ project.id }}" aria-expanded="true" aria-controls="collapse{{ project.id }}">
                    {{ project.name }}
                </button>
            </h2>
            <div id="collapse{{ project.id }}" class="accordion-collapse collapse" aria-labelledby="heading{{ project.id }}" data-bs-parent="#projectsAccordion">
                <div class="accordion-body">
                    <p>{{ project.description or "No description" }}</p>
                    <ul class="list-group">
                        {% for task in project.tasks[:5] %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            {{ task.title }}
                            <form method="POST" action="{{ url_for('complete_task', task_id=task.id) }}" class="d-inline">
                                {{ form.hidden_tag() }}
                                <input type="checkbox" {% if task.status.value == 'Done' %}checked{% endif %} onclick="this.form.submit();">
                            </form>
                        </li>
                        {% endfor %}
                    </ul>
                    <a href="{{ url_for('project_tasks', project_id=project.id) }}" class="btn btn-link mt-2">View All Tasks</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}